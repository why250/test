根据提供的 `README.md` 文档，整理后的测试需求说明书如下：

# 测试需求说明书 v1.0

**项目目标**：通过 Python 函数实现自动化测试功能，主要包含上电/下电控制、设备配置及直流线性度测试 [1]。

---

## 1. 上电顺序控制 (Power On)

### 1.1 设备连接

* **连接方式**：需通过 VISA 地址连接 DP 电源设备。
* **配置文件**：读取 `visa.txt` 获取 VISA 地址（例如：`USB0::0x1AB1::0xA4A8::DP2A265201089::INSTR`）[1]。

### 1.2 参数配置

* **配置文件**：读取 `Power_on_config.txt`。
* **参数定义**：定义通道的上电顺序及参数，格式为 `(DP名称, 通道号, 目标电压V, 限流A)`。
  * 示例：`(DP1, CH1, 2.3, 0.5)` [1]。

### 1.3 执行流程

1. **按序上电**：按照配置文件定义的顺序开启通道。
2. **记录电流**：上电后读取并记录实际电流值。
3. **结果判定**：
   * 读取 `Power_limit_config.txt` 获取电流限制范围（如 `0.4A-0.5A`）。
   * 比较实际电流值是否在设定范围内。
4. **结果保存**：将电流结果和比较结果保存至文件，文件命名格式为 `"Power_on_result"+测试时间+".txt"` [1]。

---

## 2. 下电顺序控制 (Power Off)

* **执行流程**：按照与“上电顺序控制”完全相反的顺序进行下电操作 [1]。

---

## 3. 设备配置 (DAC 与电源)

### 3.1 DAC 配置

* **连接方式**：通过串口（COM）连接 DAC 设备。
* **参数配置**：
  * 读取 `DAC_Config.txt`，格式为 `DACx 档位(2.5/5/10/20) 电压值`。
  * 需支持 16bit DAC，根据档位和电压值转换为 DAC 码。
* **命令发送**：
  * 生成配置命令格式：`f"OUTPUT{i} {channel} {dac_code};"`。
  * 需支持扫描指定通道（例如：扫描 DAC20，设定初值 -0.2，终值 0.2，步进 0.01）[1]。

### 3.2 电源控制

* **控制逻辑**：根据 `Power_Config.txt` 中的参数生成控制命令，格式与上电配置一致（DP 名称、通道、电压、限流）[1]。

---

## 4. 直流线性度测试

### 4.1 测试连接

* 连接万用表（DM）作为测量设备，读取的值定义为“输出参数” [1]。

### 4.2 扫描方式

支持两种“输入参数”扫描模式：

1. **DAC 扫描**：扫描 DAC 某一指定通道（如初值 -0.2，终值 0.2，步进 0.01）。
2. **DG 扫描**：连接 DG（信号发生器），扫描 DG 直流输出（如初值 -0.2，终值 0.2，步进 0.01）[1]。

### 4.3 分析与结果

* **数据分析**：
  * 绘制“输入参数”与“输出参数”的关系图。
  * 计算关键参数：增益 (Gain)、偏移 (Offset)、非线性度 (non_linearity)、DNL (微分非线性)、INL (积分非线性)。
* **结果保存**：
  * 允许用户选择保存路径。
  * 默认路径：`./results`。
  * 默认文件名：`"dc_linearity_result"+测试时间+".txt"` [1]。
